spring:
  main:
    lazy-initialization: true
  jackson:
    time-zone: Asia/Seoul
  application:
    name: hiteen

  r2dbc:
    url: r2dbc:postgresql://10.8.3.89:5432/hiteen
    username: hiteen
    password: hiteen@2025
    pool:
      enabled: true
      initial-size: 10
      max-size: 80
      max-idle-time: 60s
      max-life-time: 30m
      validation-query: "SELECT 1"
      acquire-timeout: 10s
      max-create-connection-time: 10s

  liquibase:
#    enabled: true
    url: jdbc:postgresql://10.8.3.89:5432/hiteen
    user: hiteen
    password: hiteen@2025
    change-log: classpath:db/changelog/db.changelog-master.yaml

  data:
    mongodb:
      uri: mongodb://hiteen:hiteen%402025@10.8.2.156:27017/hiteen?authSource=admin
    redis:
      repositories:
        enabled: false
      password: hiteen1234
      timeout: 5s
      client-type: lettuce

      cluster:
        enabled: true
        max-redirects: 5
        nodes:
          - redis-0.redis.hiteen.svc.cluster.local:6379
          - redis-1.redis.hiteen.svc.cluster.local:6379
          - redis-2.redis.hiteen.svc.cluster.local:6379
          - redis-3.redis.hiteen.svc.cluster.local:6379
          - redis-4.redis.hiteen.svc.cluster.local:6379
          - redis-5.redis.hiteen.svc.cluster.local:6379

      lettuce:
        pool:
          max-active: 16
          max-idle: 8
          min-idle: 2
          time-between-eviction-runs: 60s


  config:
    import:
      - "classpath:mbti.yml"
      - "classpath:exp.yml"

  devtools:
    livereload.enabled: true
    restart.enabled: true

server:
  port: 8080


management:
  endpoint:
    health:
      probes:
        enabled: true       # ⭐ liveness/readiness 분리 핵심
  health:
    redis:
      enabled: true
    mongo:
      enabled: true
    r2dbc:
      enabled: true
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  metrics:
    tags:
      application: hiteen



# --------------------
# Custom Application Settings
# --------------------
app:
  asset:
    storage-root: /app/assets
    allowed-exts: jpg,jpeg,png,gif,webp,bmp,svg,mp4,mov,avi,mkv,pdf,txt,csv,zip,rar,gz,mp3
    max-size-bytes: 52428800  # 50MB
  join:
    rejoin-days: 30
    dev-allow-always: false


# --------------------
# MinIO (S3 호환) 설정 추가
# --------------------
#cloud:
#  aws:
#    s3:
#      endpoint: http://hiteen-minio.hiteen.svc.cluster.local:9000
#      access-key: minioadmin
#      secret-key: minioadmin123
#      path-style-access-enabled: true


# --------------------
# External Integrations
# --------------------
admob:
  key-url: https://www.gstatic.com/admob/reward/verifier-keys.json

jwt:
  secret: ac0da6c32199d5d4829ca62b05f2a353ab926e2855de718e28286ca64bc2f9df
  access-expiration: 864000000
#  2주
#  refresh-expiration: 1209600000
#  1년
#  refresh-expiration: 31536000000
#  10년
  refresh-expiration: 315360000000


springdoc:
  api-docs.path: /api-docs
  swagger-ui.path: /swagger-ui

soketi:
  host: soketi-svc.hiteen.svc.cluster.local
  port: 6001
  app-id: hiteen-app
  app-key: hiteen-key
  app-secret: hiteen-secret

sms:
  callback: "1577-5993"
  api-key: 0rsw46blu616mp6geidaldsy9z6o0pgi
  api-url: https://apis.aligo.in/send/
  user-id: jiasoft
  kakao:
    sender-key: KAKAO_SENDER_KEY
    token-url: https://kakaoapi.aligo.in/akv10/token/create/30/s/
    alimtalk-url: https://kakaoapi.aligo.in/akv10/alimtalk/send/
    detail-url: https://kakaoapi.aligo.in/akv10/history/detail/

batch:
  enabled: true

giftishow:
  url: "https://bizapi.giftishow.com/bizApi"
  auth-key: "REAL626e92ac568f4330947dd8793622e9ac"
  token-key: "0F3WhVAAAx6iuIFzIcF7Gg=="
  template-id: "202404120253800"
  banner-id: "202404120290767"
  callback: "15775993"
  user-id: "ceo@jiasoft.kr"
  admin-phone: "01026490217|01066227103|01099136543"

neis:
  base-url: "https://open.neis.go.kr/hub"
  api-key: "458d6485b25c46009758a4ab53413497"

kakao:
  base-url: "https://dapi.kakao.com/v2/local"
  api-key: "6ba92dcdddc5dccc78dbbaa50eb95825"



#mqtt:
#  broker:
#    uri: tcp://192.168.49.2:30002
#  topic: $share/group1/location/#
#  client:
#    id: tbmq_spring
#  username: tbmq_spring
#  password: tbmq_spring
#  cleanStart: false
#  automaticReconnect: true
#  sessionExpiryInterval: 604800
#  keepAliveInterval: 60
#  qos: 1

# 미사용
tbmq:
  url: http://192.168.49.2:30001
  admin:
    username: sysadmin@thingsboard.org
    password: sysadmin
  mqtt:
    host: 192.168.49.2
    port: 30002
    tls: false

logging:
  level:
    io.r2dbc.postgresql.QUERY: INFO
    io.r2dbc.postgresql.PARAM: DEBUG

    org.springframework.r2dbc.core: DEBUG

    org.mongodb.driver: INFO
    org.mongodb.driver.connection: INFO
    org.mongodb.driver.protocol.command: INFO
    org.mongodb.driver.protocol.query: INFO
    org.mongodb.driver.cluster: INFO

    org.springframework.security: INFO
    org.springframework.cache: INFO
